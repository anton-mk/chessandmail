//класс для отправки запроса на серверfunction cl_to_server_(){  this.id_game_ =0; //номер партии  this.last_id_ =-1;} //cl_to_server_function cl_control_comments_game(id_game){  this.id_game_ =id_game; //номер партии  this.last_id_ =-1; //id последнего комментария  this.o_xmlhttp_status_ =createXMLHttp(); //объект для опроса статуса партии  this.o_timer_status_ =null; //объект Timer для опроса статуса партии  this.login_white =''; //логин игрока белыми  this.login_black =''; //логин игрока черными//------------------------------------------------------------------------------------  this.show_comments=function(o_result_){    var s ='';    var d ='';    var c =o_result_.comments_.length;    if (c > 0){      for(var i=0; i < c; i++){        d ='<DIV style="color: blue; text-decoration: underline">';        if (o_result_.comments_[i].isWhite_)            d +=this.login_white;          else            d +=this.login_black;        d +='</DIV>';        d +='<DIV>' + o_result_.comments_[i].comment_ + '</DIV>';        s =d +s;        this.last_id_ =o_result_.comments_[i].id_;      }//for      s +=document.getElementById('list_comments').innerHTML;      document.getElementById('list_comments').innerHTML =s;    }  }//show_comments//------------------------------------------------------------------------------------//------------------------------------------------------------------------------------  this.onready_status =function(){    var o_result_;    var o_this_ =this;    if (this.o_xmlhttp_status_.readyState ==4){      if (this.o_xmlhttp_status_.status ==200){        try{//        alert(this.o_xmlhttp_status_.responseText);          o_result_ =JSON.parse(this.o_xmlhttp_status_.responseText);//          alert(o_result_.text_error_);          if (o_result_.text_error_ ==='')            this.show_comments(o_result_);        }catch(e){//        alert(this.o_xmlhttp_status_.responseText);        }      }      this.o_timer_status_ =window.setTimeout(function(){o_this_.read_status();},5000);    }  }//onready_status//------------------------------------------------------------------------------------//------------------------------------------------------------------------------------  this.read_status =function(){    var q_ =new cl_to_server_();    var o_this_ =this;    q_.id_game_=this.id_game_;    q_.last_id_ =this.last_id_;    if (this.o_xmlhttp_status_.readyState !=0)      this.o_xmlhttp_status_.abort();    this.o_xmlhttp_status_.open("post","ajax_comments_game.php",true);    this.o_xmlhttp_status_.onreadystatechange=function(){      o_this_.onready_status();    }    this.o_xmlhttp_status_.send(JSON.stringify(q_));  }//read_status//------------------------------------------------------------------------------------//------------------------------------------------------------------------------------  this.init =function(){    if (this.o_xmlhttp_status_)      this.read_status();  }//init//------------------------------------------------------------------------------------}//cl_control_comments_game